@startuml
ESP -> "filaLogGeral()": Qualquer parte do\nprograma passa uma\nstring para essa funcao
"filaLogGeral()" -> "filaLogGeral()":Com a string recebida,\nadiciona o horario atual a ela
"filaLogGeral()" -> Fila_Log_Geral: Adiciona a mensagem a fila
loop infinite times
            loop enquanto nao estiver disponivel
            Thread_escreveLogGeral -> xSemaphoreLogs: Verifica disponibilidade\ndo semaforo
            end
            xSemaphoreLogs --> Thread_escreveLogGeral:Semaforo Livre
            Thread_escreveLogGeral -> Fila_Log_Geral: Requisita uma string para a fila
            Fila_Log_Geral -> Thread_escreveLogGeral: Remove o primeiro\nelemento e o envia
            Thread_escreveLogGeral -> "escreveParaArquivoLog()": Passa a string que recebeu da fila,\num sinalizador para dizer qual o tipo de log(geral/envio) e,\no numero do arquivo atual em que esta escrevendo
            "escreveParaArquivoLog()" -> "escreveParaArquivoLog()": Configura o arquivo onde vai escrever
            "escreveParaArquivoLog()" -> Mem_Nao_VolatilSpiff: Abre o arquivo, em modo append, escreve nele e o fecha
            "escreveParaArquivoLog()" -> Thread_escreveLogGeral:
            Thread_escreveLogGeral -> xSemaphoreLogs: Libera o semaforo
            Thread_escreveLogGeral -> Thread_escreveLogGeral: Sleep para liberar o processador
            Thread_escreveLogGeral -> Thread_escreveLogGeral: Incrementa o contador de escritas
            alt Contador chegou no valor maximo
            Thread_escreveLogGeral -> Mem_Nao_VolatilSpiff: Abre o arquivo em modo W,\napaga o que estava escrito,\nseta o indicador do arquivo para\no novo arquivo e, zera o contador de escritas
            else Arquivo ainda tem espaco
            Thread_escreveLogGeral -> Thread_escreveLogGeral: Segue com a execucao
            end
            Thread_escreveLogGeral -> Thread_escreveLogGeral: Verifica um contador de escritas,\ncaso tenha chegado ao valor especificado,\napaga o arquivo seguinte,\natualiza o sinalizador de arquivo e\nzera o contador

        end
note over ESP: As duas threads de escrever em arquivos funcionam de maneira igual
@enduml